import{j as s}from"./query-DgI8Fk8U.js";import{r as i}from"./vendor-CaRZ0yde.js";import{aD as j,aB as w,aC as E,aE as S,aF as M,aG as A,aH as T}from"./index-CxiqTODc.js";import{b0 as I,b7 as L,a5 as N}from"./ui-D4K0M9g8.js";import"./mapbox-X6c54b3e.js";const k=()=>s.jsx("div",{className:"bg-[#091020] rounded-lg p-6 border border-[#1a202c] flex items-center justify-center h-[350px]",children:s.jsx(j,{isLoading:!0,variant:"default",estimatedTime:1500,stages:[{id:"map",label:"Loading map tiles...",duration:600,weight:.4},{id:"data",label:"Loading location data...",duration:500,weight:.3},{id:"render",label:"Rendering map...",duration:400,weight:.3}]})}),C=({error:t})=>s.jsxs(w,{variant:"destructive",className:"mb-4",children:[s.jsx(I,{className:"h-4 w-4"}),s.jsx(E,{children:t})]}),H=[{featureType:"all",elementType:"geometry",stylers:[{color:"#242f3e"}]},{featureType:"all",elementType:"labels.text.stroke",stylers:[{color:"#242f3e"},{lightness:-80}]},{featureType:"all",elementType:"labels.text.fill",stylers:[{color:"#746855"},{lightness:40}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#17263c"}]}],F={width:"100%",height:"350px",borderRadius:"0.5rem"},q=({center:t,zoom:e,onLoad:r,children:o})=>{const n=i.useRef(null),l=i.useCallback(c=>{n.current=c,r&&r(c)},[r]);return s.jsx(S,{mapContainerStyle:F,center:t,zoom:e,onLoad:l,options:{styles:H,mapTypeControl:!1,streetViewControl:!1,fullscreenControl:!0,zoomControl:!0},children:o})},B=({position:t,title:e,onClick:r,onLoad:o})=>{const n=()=>{if(!(typeof google>"u"||!google.maps))return{path:google.maps.SymbolPath.CIRCLE,scale:12,fillColor:"#5B9BD5",fillOpacity:1,strokeColor:"#FFFFFF",strokeWeight:2}},l=()=>{if(!(typeof google>"u"||!google.maps))return google.maps.Animation.DROP};return s.jsx(M,{position:t,onClick:r,icon:n(),animation:l(),title:e,onLoad:o,visible:!0,zIndex:1e3})},R=({facility:t,position:e,onCloseClick:r})=>{const o=()=>t.features?Array.isArray(t.features)?t.features.length>0:Object.values(t.features).some(l=>!!l):!1,n=()=>typeof google>"u"||!google.maps?{maxWidth:320,zIndex:999}:{pixelOffset:new google.maps.Size(0,-10),maxWidth:320,zIndex:999};return s.jsx(A,{position:e,onCloseClick:r,options:n(),children:s.jsxs("div",{className:"p-0 max-w-[300px] bg-[#131a2a]",children:[s.jsx("div",{className:"bg-[#091020] px-5 py-5",children:s.jsx("h3",{className:"text-xl font-bold text-[#5B9BD5]",children:t.name})}),s.jsxs("div",{className:"px-5 pt-4 pb-5",children:[t.address&&s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx(L,{className:"w-5 h-5 text-[#5B9BD5]"}),s.jsx("span",{children:t.address})]}),t.phone&&s.jsxs("div",{className:"flex items-center gap-2 mb-5",children:[s.jsx(N,{className:"w-5 h-5 text-[#5B9BD5]"}),s.jsx("span",{children:t.phone})]}),o()&&s.jsxs("div",{className:"mb-5",children:[s.jsx("h4",{className:"text-sm font-bold text-[#5B9BD5] uppercase mb-3",children:"FACILITIES & AMENITIES"}),s.jsx("div",{className:"grid grid-cols-2 gap-3",children:Array.isArray(t.features)?t.features.map((l,c)=>s.jsx("span",{className:"facility-feature",children:l},c)):t.features&&s.jsxs(s.Fragment,{children:[t.features.indoor&&s.jsx("span",{className:"facility-feature",children:"Indoor"}),t.features.climate_controlled&&s.jsx("span",{className:"facility-feature",children:"Climate Controlled"}),t.features["24h_access"]&&s.jsx("span",{className:"facility-feature",children:"24/7 Access"}),t.features.security_system&&s.jsx("span",{className:"facility-feature",children:"Security"}),t.features.vehicle_washing&&s.jsx("span",{className:"facility-feature",children:"Vehicle Washing"})]})})]}),t.description&&s.jsx("div",{className:"border-l-2 border-[#5B9BD5] pl-3 italic",children:s.jsx("p",{children:t.description})})]})]})})},D=t=>{t.current.forEach(e=>{const r=e.getIcon();if(r){const o=typeof r=="object"&&"url"in r?r.url:null;if(o){const n=document.querySelector(`.gm-style img[src="${o}"]`);n instanceof HTMLElement&&(n.style.visibility="visible",n.style.opacity="1",n.style.display="block")}}})},g=t=>{t&&setTimeout(()=>{document.querySelectorAll('.gm-style img[src*="marker"]').forEach(e=>{e instanceof HTMLElement&&(e.style.visibility="visible",e.style.opacity="1",e.style.display="block",e.style.zIndex="1000")}),document.querySelectorAll('.gm-style div[title="Close"]').forEach(e=>{e instanceof HTMLElement&&(e.style.display="none")}),document.querySelectorAll('.gm-ui-hover-effect, .gm-style img[src*="arrow"], .gm-style button, .gm-control-active').forEach(e=>{e instanceof HTMLElement&&(e.style.display="none",e.style.visibility="hidden",e.style.opacity="0")}),document.querySelectorAll(".gm-style-iw-a, .gm-style-iw-t").forEach(e=>{e instanceof HTMLElement&&e.querySelectorAll("img").forEach(o=>{o.style.display="none",o.style.visibility="hidden",o.style.opacity="0"})}),document.querySelectorAll(".gm-style-iw, .gm-style-iw-c, .gm-style-iw-d").forEach(e=>{e instanceof HTMLElement&&(e.style.overflow="auto",e.style.maxHeight="none",e.style.boxSizing="border-box",e.style.padding="12px")})},500)},W=()=>{const t=()=>{document.querySelectorAll('.gm-ui-hover-effect, .gm-style img[src*="arrow"]').forEach(r=>{r instanceof HTMLElement&&(r.style.display="none",r.style.visibility="hidden",r.style.opacity="0")}),document.querySelectorAll(".gm-style button, .gm-control-active, .gm-svpc").forEach(r=>{r instanceof HTMLElement&&(r.style.display="none",r.style.visibility="hidden")}),document.querySelectorAll(".gm-style-iw-c").forEach(r=>{r instanceof HTMLElement&&(r.style.padding="12px",r.style.borderRadius="8px",r.style.boxShadow="0 2px 7px 1px rgba(0, 0, 0, 0.3)",r.style.maxHeight="none")}),document.querySelectorAll(".gm-style-iw-d").forEach(r=>{r instanceof HTMLElement&&(r.style.overflow="auto !important",r.style.maxHeight="none !important")}),document.querySelectorAll(".gm-style-iw-t").forEach(r=>{r.querySelectorAll("img").forEach(n=>{n instanceof HTMLElement&&(n.style.display="none",n.style.visibility="hidden",n.style.opacity="0")})});const e=document.querySelectorAll('.gm-style img[src*="marker"]').length;e>0&&console.log(`Found ${e} markers to make visible`)};return t(),setInterval(t,2e3)},h=()=>{document.querySelectorAll(".gm-style-iw, .gm-style-iw-c, .gm-style-iw-d").forEach(t=>{if(t instanceof HTMLElement){t.style.overflow="auto",t.style.maxHeight="none";const e=t.querySelector("div");e instanceof HTMLElement&&(e.style.overflow="auto",e.style.maxHeight="300px")}})},_=({apiKey:t,location:e,zoom:r=14,facilities:o=[],onMapLoad:n})=>{const[l,c]=i.useState(null),f=i.useRef([]),y=i.useRef(null),m=i.useRef(null),{isLoaded:x,error:p}=T({apiKey:t}),b=a=>{y.current=a,g(a),m.current=W(),setTimeout(h,1e3),n&&n()};i.useEffect(()=>()=>{m.current!==null&&clearInterval(m.current)},[]),i.useEffect(()=>{if(l){const a=()=>{D(f),g(y.current),h(),document.querySelectorAll('.gm-ui-hover-effect, .gm-style img[src*="arrow"]').forEach(d=>{d instanceof HTMLElement&&(d.style.display="none",d.style.visibility="hidden",d.style.opacity="0")})};a();const u=setInterval(a,300);return()=>clearInterval(u)}},[l]);const v=o.length>0?o:[{name:"Location",address:"Pin location",description:"View details for this location"}];return x?s.jsxs("div",{className:"bg-[#091020] rounded-lg p-4 border border-[#1a202c] w-full",children:[p&&s.jsx(C,{error:p}),s.jsx("div",{className:"w-full overflow-hidden rounded-lg relative",children:s.jsxs(q,{center:e,zoom:r,onLoad:b,children:[v.map((a,u)=>s.jsx(B,{position:e,title:a.name,onClick:()=>c(a),onLoad:d=>{f.current.push(d)}},`marker-${u}`)),l&&s.jsx(R,{facility:l,position:e,onCloseClick:()=>c(null)})]})})]}):s.jsx(k,{})};export{_ as default};
